<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NeQuickG_JRC: /home/eriol/Projects/JRC_NeQuickG_all_versions/NeQuickJRC/src/lib/private/NeQuickG_JRC_TEC_integration.h File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../EC_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NeQuickG_JRC
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="../../dir_c85d3e3c5052e9ad9ce18c6863244a25.html">lib</a></li><li class="navelem"><a class="el" href="../../dir_068e1ab73490378deb78d08deaeedc2a.html">private</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">NeQuickG_JRC_TEC_integration.h File Reference<div class="ingroups"><a class="el" href="../../db/dee/group___ne_quick_g___j_r_c.html">NeQuickG_JRC_lib [NeQuickG_JRC]</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;math.h&gt;</code><br />
<code>#include &quot;<a class="el" href="../../d6/d50/_ne_quick_g___j_r_c__context_8h_source.html">NeQuickG_JRC_context.h</a>&quot;</code><br />
</div>
<p><a href="../../d2/d0d/_ne_quick_g___j_r_c___t_e_c__integration_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a2ddb49492b3b73efb3f373822191627b"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d0d/_ne_quick_g___j_r_c___t_e_c__integration_8h.html#a2ddb49492b3b73efb3f373822191627b">NeQuickG_integrate</a> (<a class="el" href="../../d6/d50/_ne_quick_g___j_r_c__context_8h.html#a17674389543791a941392bd170a6bf8e">NeQuickG_context_t</a> *const pContext, double_t *const pTEC)</td></tr>
<tr class="separator:a2ddb49492b3b73efb3f373822191627b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>NeQuickG Total Electron Content (TEC) integration routine<br />
</p>
<p>the Total Electron Content (TEC) is defined as the electron density in a cross-section of 1m<sup>2</sup>, integrated along a slant (or vertical) path between two points (e.g. a satellite and a receiver); it is expressed in TEC units (TECU) where 1 TECU equals 10<sup>16</sup> electrons/m<sup>2</sup></p>
<dl class="section author"><dt>Author</dt><dd>Angela Aragon-Angel (<a href="#" onclick="location.href='mai'+'lto:'+'mar'+'ia'+'-an'+'ge'+'les'+'.a'+'rag'+'on'+'@ec'+'.e'+'uro'+'pa'+'.eu'; return false;">maria<span style="display: none;">.nosp@m.</span>-ang<span style="display: none;">.nosp@m.</span>eles.<span style="display: none;">.nosp@m.</span>arag<span style="display: none;">.nosp@m.</span>on@ec<span style="display: none;">.nosp@m.</span>.eur<span style="display: none;">.nosp@m.</span>opa.e<span style="display: none;">.nosp@m.</span>u</a>)</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>Joint Research Centre (JRC), 2019<br />
 This software has been released as free and open source software under the terms of the European Union Public Licence (EUPL), version 1.<br />
 Questions? Submit your query at <a href="https://www.gsc-europa.eu/contact-us/helpdesk">https://www.gsc-europa.eu/contact-us/helpdesk</a> </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a2ddb49492b3b73efb3f373822191627b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ddb49492b3b73efb3f373822191627b">&#9670;&nbsp;</a></span>NeQuickG_integrate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t NeQuickG_integrate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/d50/_ne_quick_g___j_r_c__context_8h.html#a17674389543791a941392bd170a6bf8e">NeQuickG_context_t</a> *const&#160;</td>
          <td class="paramname"><em>pContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double_t *const&#160;</td>
          <td class="paramname"><em>pTEC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function checks whether the ray is vertical or slant, and where the start and end points are located in regards to the different integration points, before passing the appropriate information to the integration function. See F.2.3.3.<br />
</p>
<p>For each integration point in the path the routine gets the electron density with the effective inosization level, time of day and month. Then, integrates STEC for all points in the path.<br />
</p>
<p>The STEC integration routine used in this implementation is the method based on Kronrod G<sub>7</sub>-K<sub>15</sub> adaptive quadrature with the default tolerances defined in the specification. See section F.2.6.<br />
 The maximum recursion level for the integration routine is <a class="el" href="../../d3/d7c/_ne_quick_g___j_r_c___t_e_c__integration_8c.html#a624f1e2bf9de4a4d97fe6ee6beb4f9dd">NEQUICK_G_JRC_RECURSION_LIMIT_MAX</a><br />
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">pContext</td><td>Nequick context </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pTEC</td><td>Total electron content in km/m<sup>3</sup> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>on success NEQUICK_OK </dd></dl>
<div class="fragment"><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                        {</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  int32_t ret;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  *pTEC = 0.0;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="keywordflow">if</span> (pContext-&gt;<a class="code" href="../../d4/d8a/struct_ne_quick_g__context__st.html#a134aff5dfbfbe3f8ef62248649d1455d">ray</a>.<a class="code" href="../../d8/d3e/struct_ne_quick_g__ray__context__st.html#ac00f3c123a2ca56a111cda4863d90c6c">is_vertical</a>) {</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    ret = <a class="code" href="../../d7/d0c/_ne_quick_g___j_r_c__ray__vertical_8c.html#a248bc77ac87b1b6f73604b09524abe04">ray_vertical_get_profile</a>(pContext);</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordflow">if</span> (ret != <a class="code" href="../../d3/dbe/_ne_quick_g___j_r_c_8h.html#a04015ae3b988eb64d181ffda2b3f6b54">NEQUICK_OK</a>) {</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    }</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  }</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d3/d7c/_ne_quick_g___j_r_c___t_e_c__integration_8c.html#a5f52220213229a808680aae280724aab">IS_SATELLITE_BELOW_FIRST_POINT</a>(pContext)) {</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d3/d7c/_ne_quick_g___j_r_c___t_e_c__integration_8c.html#a676a44a557fae57ce4879cbc5c37d0e8">both_below_first_integration_point</a>(pContext, pTEC);</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  }</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d3/d7c/_ne_quick_g___j_r_c___t_e_c__integration_8c.html#a81dd5483ed33e4bd31dddbce5e3d45a4">IS_SATELLITE_BELOW_SECOND_POINT</a>(pContext)) {</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d3/d7c/_ne_quick_g___j_r_c___t_e_c__integration_8c.html#aed4b4d003ab4f04caee8fcc98f6cdb63">IS_RECEIVER_ABOVE_FIRST_POINT</a>(pContext) ?</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      <a class="code" href="../../d3/d7c/_ne_quick_g___j_r_c___t_e_c__integration_8c.html#ae5f0b9e2960febfd3b636f1620ad134d">between_integration_points</a>(pContext, pTEC) :</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      <a class="code" href="../../d3/d7c/_ne_quick_g___j_r_c___t_e_c__integration_8c.html#adb26249a7498e68a992747cbfd1debb6">path_crosses_first_integration_point</a>(pContext, pTEC);</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  }</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d3/d7c/_ne_quick_g___j_r_c___t_e_c__integration_8c.html#a06246724c043ba818c3632f47841d2fd">IS_RECEIVER_ABOVE_SECOND_POINT</a>(pContext)) {</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d3/d7c/_ne_quick_g___j_r_c___t_e_c__integration_8c.html#a98a3642a038b8866ac79e0badc46a5a4">both_above_second_integration_point</a>(pContext, pTEC);</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  }</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="../../d3/d7c/_ne_quick_g___j_r_c___t_e_c__integration_8c.html#aed4b4d003ab4f04caee8fcc98f6cdb63">IS_RECEIVER_ABOVE_FIRST_POINT</a>(pContext)) {</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d3/d7c/_ne_quick_g___j_r_c___t_e_c__integration_8c.html#a8521ca9e8fc54a0b579e1b26691a99ce">path_crosses_second_integration_point</a>(pContext, pTEC);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  }</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="../../d3/d7c/_ne_quick_g___j_r_c___t_e_c__integration_8c.html#aa1eaf21f1f5c887bc4ff302c65a5c017">path_crosses_both_integration_points</a>(pContext, pTEC);</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;}</div><div class="ttc" id="_ne_quick_g___j_r_c___t_e_c__integration_8c_html_a98a3642a038b8866ac79e0badc46a5a4"><div class="ttname"><a href="../../d3/d7c/_ne_quick_g___j_r_c___t_e_c__integration_8c.html#a98a3642a038b8866ac79e0badc46a5a4">both_above_second_integration_point</a></div><div class="ttdeci">static int32_t both_above_second_integration_point(NeQuickG_context_t *const pContext, double_t *const pTEC)</div><div class="ttdef"><b>Definition:</b> NeQuickG_JRC_TEC_integration.c:265</div></div>
<div class="ttc" id="_ne_quick_g___j_r_c___t_e_c__integration_8c_html_aa1eaf21f1f5c887bc4ff302c65a5c017"><div class="ttname"><a href="../../d3/d7c/_ne_quick_g___j_r_c___t_e_c__integration_8c.html#aa1eaf21f1f5c887bc4ff302c65a5c017">path_crosses_both_integration_points</a></div><div class="ttdeci">static int32_t path_crosses_both_integration_points(NeQuickG_context_t *const pContext, double_t *const pTEC)</div><div class="ttdef"><b>Definition:</b> NeQuickG_JRC_TEC_integration.c:294</div></div>
<div class="ttc" id="struct_ne_quick_g__ray__context__st_html_ac00f3c123a2ca56a111cda4863d90c6c"><div class="ttname"><a href="../../d8/d3e/struct_ne_quick_g__ray__context__st.html#ac00f3c123a2ca56a111cda4863d90c6c">NeQuickG_ray_context_st::is_vertical</a></div><div class="ttdeci">bool is_vertical</div><div class="ttdef"><b>Definition:</b> NeQuickG_JRC_ray.h:51</div></div>
<div class="ttc" id="struct_ne_quick_g__context__st_html_a134aff5dfbfbe3f8ef62248649d1455d"><div class="ttname"><a href="../../d4/d8a/struct_ne_quick_g__context__st.html#a134aff5dfbfbe3f8ef62248649d1455d">NeQuickG_context_st::ray</a></div><div class="ttdeci">ray_context_t ray</div><div class="ttdef"><b>Definition:</b> NeQuickG_JRC_context.h:32</div></div>
<div class="ttc" id="_ne_quick_g___j_r_c___t_e_c__integration_8c_html_a06246724c043ba818c3632f47841d2fd"><div class="ttname"><a href="../../d3/d7c/_ne_quick_g___j_r_c___t_e_c__integration_8c.html#a06246724c043ba818c3632f47841d2fd">IS_RECEIVER_ABOVE_SECOND_POINT</a></div><div class="ttdeci">#define IS_RECEIVER_ABOVE_SECOND_POINT(_p)</div><div class="ttdef"><b>Definition:</b> NeQuickG_JRC_TEC_integration.c:45</div></div>
<div class="ttc" id="_ne_quick_g___j_r_c_8h_html_a04015ae3b988eb64d181ffda2b3f6b54"><div class="ttname"><a href="../../d3/dbe/_ne_quick_g___j_r_c_8h.html#a04015ae3b988eb64d181ffda2b3f6b54">NEQUICK_OK</a></div><div class="ttdeci">#define NEQUICK_OK</div><div class="ttdef"><b>Definition:</b> NeQuickG_JRC.h:74</div></div>
<div class="ttc" id="_ne_quick_g___j_r_c___t_e_c__integration_8c_html_ae5f0b9e2960febfd3b636f1620ad134d"><div class="ttname"><a href="../../d3/d7c/_ne_quick_g___j_r_c___t_e_c__integration_8c.html#ae5f0b9e2960febfd3b636f1620ad134d">between_integration_points</a></div><div class="ttdeci">static int32_t between_integration_points(NeQuickG_context_t *const pContext, double_t *const pTEC)</div><div class="ttdef"><b>Definition:</b> NeQuickG_JRC_TEC_integration.c:113</div></div>
<div class="ttc" id="_ne_quick_g___j_r_c___t_e_c__integration_8c_html_a5f52220213229a808680aae280724aab"><div class="ttname"><a href="../../d3/d7c/_ne_quick_g___j_r_c___t_e_c__integration_8c.html#a5f52220213229a808680aae280724aab">IS_SATELLITE_BELOW_FIRST_POINT</a></div><div class="ttdeci">#define IS_SATELLITE_BELOW_FIRST_POINT(_p)</div><div class="ttdef"><b>Definition:</b> NeQuickG_JRC_TEC_integration.c:33</div></div>
<div class="ttc" id="_ne_quick_g___j_r_c___t_e_c__integration_8c_html_adb26249a7498e68a992747cbfd1debb6"><div class="ttname"><a href="../../d3/d7c/_ne_quick_g___j_r_c___t_e_c__integration_8c.html#adb26249a7498e68a992747cbfd1debb6">path_crosses_first_integration_point</a></div><div class="ttdeci">static int32_t path_crosses_first_integration_point(NeQuickG_context_t *const pContext, double_t *const pTEC)</div><div class="ttdef"><b>Definition:</b> NeQuickG_JRC_TEC_integration.c:141</div></div>
<div class="ttc" id="_ne_quick_g___j_r_c___t_e_c__integration_8c_html_a676a44a557fae57ce4879cbc5c37d0e8"><div class="ttname"><a href="../../d3/d7c/_ne_quick_g___j_r_c___t_e_c__integration_8c.html#a676a44a557fae57ce4879cbc5c37d0e8">both_below_first_integration_point</a></div><div class="ttdeci">static int32_t both_below_first_integration_point(NeQuickG_context_t *const pContext, double_t *const pTEC)</div><div class="ttdef"><b>Definition:</b> NeQuickG_JRC_TEC_integration.c:88</div></div>
<div class="ttc" id="_ne_quick_g___j_r_c___t_e_c__integration_8c_html_aed4b4d003ab4f04caee8fcc98f6cdb63"><div class="ttname"><a href="../../d3/d7c/_ne_quick_g___j_r_c___t_e_c__integration_8c.html#aed4b4d003ab4f04caee8fcc98f6cdb63">IS_RECEIVER_ABOVE_FIRST_POINT</a></div><div class="ttdeci">#define IS_RECEIVER_ABOVE_FIRST_POINT(_p)</div><div class="ttdef"><b>Definition:</b> NeQuickG_JRC_TEC_integration.c:41</div></div>
<div class="ttc" id="_ne_quick_g___j_r_c___t_e_c__integration_8c_html_a81dd5483ed33e4bd31dddbce5e3d45a4"><div class="ttname"><a href="../../d3/d7c/_ne_quick_g___j_r_c___t_e_c__integration_8c.html#a81dd5483ed33e4bd31dddbce5e3d45a4">IS_SATELLITE_BELOW_SECOND_POINT</a></div><div class="ttdeci">#define IS_SATELLITE_BELOW_SECOND_POINT(_p)</div><div class="ttdef"><b>Definition:</b> NeQuickG_JRC_TEC_integration.c:37</div></div>
<div class="ttc" id="_ne_quick_g___j_r_c___t_e_c__integration_8c_html_a8521ca9e8fc54a0b579e1b26691a99ce"><div class="ttname"><a href="../../d3/d7c/_ne_quick_g___j_r_c___t_e_c__integration_8c.html#a8521ca9e8fc54a0b579e1b26691a99ce">path_crosses_second_integration_point</a></div><div class="ttdeci">static int32_t path_crosses_second_integration_point(NeQuickG_context_t *const pContext, double_t *const pTEC)</div><div class="ttdef"><b>Definition:</b> NeQuickG_JRC_TEC_integration.c:204</div></div>
<div class="ttc" id="_ne_quick_g___j_r_c__ray__vertical_8c_html_a248bc77ac87b1b6f73604b09524abe04"><div class="ttname"><a href="../../d7/d0c/_ne_quick_g___j_r_c__ray__vertical_8c.html#a248bc77ac87b1b6f73604b09524abe04">ray_vertical_get_profile</a></div><div class="ttdeci">int32_t ray_vertical_get_profile(NeQuickG_context_t *const pContext)</div><div class="ttdef"><b>Definition:</b> NeQuickG_JRC_ray_vertical.c:28</div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
